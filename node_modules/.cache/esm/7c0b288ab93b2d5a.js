let CustomErrorHandler,JwtService;_b93‍.x([["default",()=>_b93‍.o]]);_b93‍.w("../services/CustomErrorHandler",[["default",["CustomErrorHandler"],function(v){CustomErrorHandler=v}]]);_b93‍.w("../services/JwtService",[["default",["JwtService"],function(v){JwtService=v}]]);

const auth= async (req,resp,next)=>{
    let authHeader = req.headers.authorization;

    // console.log('authHeader=',authHeader);

    if(!authHeader){
        return next(CustomErrorHandler.unAuthorized());
    }
    
    const token = authHeader.split(' ')[1];    
    // console.log("token=",token)
    
    try{

        const {_id, role}=  JwtService.verify(token);
        const user = {
            _id,
            role
        }
        req.user=user;
        next();

    } catch(err){
        
        return next(CustomErrorHandler.unAuthorized());
    }
}

_b93‍.d(auth);